DECLARE FUNCTION CHECK! (NCOL!, NROW!)
DIM PLACES(3, 3) AS STRING
COL = 2
ROW = 2
I$ = ""
PLACES(1, 1) = "AS YOU ENTER THE GRASSY MEADOW, YOU SEE WILDFLOWERS GROWING AMONG THE GRASS, AND YOU HEAR BIRDS SINGING. THEN THE BIRDSONG COMES TO A ABRUPT HALT."
PLACES(1, 2) = "AS YOU WALK THROUGH THE WOODS, YOU CHANCE UPON A SMALL COTTAGE ALMOST HIDDEN AMONG THE TREES. THE SMOKE COMING FROM THE CHIMNEY IS GREEN! YOU DECIDE NOT TO ENTER FOR THE MOMENT."
PLACES(1, 3) = "AS YOU ENTER THE THICK FOREST, YOU SEE A LARGE TREE SOMEHOW DIFFERENT FROM THE REST. AS YOU CRANE YOUR NECK TO INSPECT IT, YOU SEE A MYSTERIOUS GLOW IN THE HIGH BRANCHES!"
PLACES(2, 1) = "AS YOU WALK UP THE GENTLE HILL, YOU NOTICE A HOLE NEAR THE BASE OF THE STANDING STONE THAT HAS BEEN THERE AS LONG AS ANYBODY CAN REMEMBER. AS YOU LOOK MORE CLOSELY YOU FIND A PASSAGE LEADING DOWN BENEATH THE STONE. THE DARKNESS SEEMS OMINOUS, AND YOU DECIDE TO KEEP AWAY FOR NOW."
PLACES(2, 2) = "AS YOU WALK INTO THE VILLAGE, YOU SEE A BAKERY, A SMALL BLACKSMITHS SHOP, A GENERAL STORE, AND A BUTCHER, AMONG OTHERS."
PLACES(2, 3) = "AS YOU GAZE AT THE MIGHTY MOUNT DAMARIN, SOMETHING ABOUT IT TUGS AT THE CORNER OF YOUR MIND. AS YOU LOOK CLOSER, YOU REALISE THE GATES TO THE COPPER MINES ARE CLOSED, AND TODAY IS A REGULAR WORKDAY! THE VILLAGE IS TO THE WEST."
PLACES(3, 1) = "AS YOU STROLL BESIDE THE RIVER, YOU THE SEE FISH DARTING ABOUT IN THE CLEAR WATER, APPARENTLY AGITATED. YOU IDLY WONDER WHAT HAD CAUSED THEIR AGITATION."
PLACES(3, 2) = "YOU CAN SEE THE RIVER FLOWING THROUGH THE VALLEY, STRADDLED BY A SIMPLE BRIDGE."
PLACES(3, 3) = "AS YOU ENTER THE CORNFIELD, YOU GRADUALLY RELAX AS YOU LISTEN TO THE SOOTHING SOUND OF THE RUSTLING CORNSTALKS. THEN YOU REALISE THE RUSTLING SOUNDS ARE COMING IN YOUR DIRECTION. YOU ARE NO LONGER RELAXED. MOUNT DAMARIN LOOMS TO THE NORTH"
SORRY$ = "YOU TRY, BUT YOU ARE THROWN BACK BY AN INVISIBLE FORCE."

GOSUB 300
100 REM MAINLOOP
    INPUT "TYPE N, S, E OR W: ", I$
    I$ = UCASE$(I$)
    IF I$ = "EXIT" THEN
        GOTO 200
    ELSEIF I$ = "N" THEN
        IF CHECK(COL, ROW - 1) THEN
            ROW = ROW - 1
            GOSUB 300
        ELSE
            PRINT SORRY$
        END IF
    ELSEIF I$ = "S" THEN
        IF CHECK(COL, ROW + 1) THEN
            ROW = ROW + 1
            GOSUB 300
        ELSE
            PRINT SORRY$
        END IF
    ELSEIF I$ = "E" THEN
        IF CHECK(COL + 1, ROW) THEN
            COL = COL + 1
            GOSUB 300
        ELSE
            PRINT SORRY$
        END IF
    ELSEIF I$ = "W" THEN
        IF CHECK(COL - 1, ROW) THEN
            COL = COL - 1
            GOSUB 300
        ELSE
            PRINT SORRY$
        END IF
    END IF
GOTO 100

200 REM END
    PRINT "NO ONE IS WATCHING AS YOU FADE FROM SIGHT, AND GRADUALLY DISAPPEAR."
END

REM SUBS

300 REM PRINTLOC
    CLS
    PRINT CHR$(9); "-------"
    FOR Y = 1 TO 3
        IF ROW = Y THEN
            A$ = "|* * *|"
            MID$(A$, COL * 2) = "@"
            PRINT CHR$(9); A$
        ELSE
            PRINT CHR$(9); "|* * *|"
        END IF
    NEXT Y
    PRINT CHR$(9); "-------"
    PRINT PLACES(ROW, COL)
RETURN

FUNCTION CHECK (NCOL, NROW)
    IF (NCOL > 3 OR NCOL < 1) OR (NROW > 3 OR NROW < 1) THEN
        CHECK = 0
    ELSE
        CHECK = -1
    END IF
END FUNCTION

